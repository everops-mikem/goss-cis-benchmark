---
# CIS Ubuntu Linux 20.04 LTS Benchmark v1.1.0
#
# 4 Logging and Auditing

command:
  # 4.2.1.4 Ensure rsyslog default file permissions configured (Automated)
  grep ^\s*\$FileCreateMode /etc/rsyslog.conf /etc/rsyslog.d/*.conf:
    exit-status: 0
    stdout:
      - $FileCreateMode 0640

  # 4.2.1.6 Ensure remote rsyslog messages are only accepted on designated log hosts.
  grep '$ModLoad imtcp' /etc/rsyslog.conf /etc/rsyslog.d/*.conf:
    exit-status: 1

  # 4.2.2.1 Ensure journald is configured to send logs to rsyslog (Automated)
  grep ForwardToSyslog /etc/systemd/journald.conf:
    exit-status: 0
    stdout:
      - ForwardToSyslog=yes

  # 4.2.2.2 Ensure journald is configured to compress large log files (Automated)
  grep Compress /etc/systemd/journald.conf:
    exit-status: 0
    stdout:
      - Compress=yes

  # 4.2.2.3 Ensure journald is configured to write logfiles to persistent disk (Automated)
  grep Storage /etc/systemd/journald.conf:
    exit-status: 0
    stdout:
      - Storage=persistent