---
disabledModules:
  - cramfs       # 1.1.1.1
  - freevxfs     # 1.1.1.2
  - jffs         # 1.1.1.3
  - hfs          # 1.1.1.4
  - hfsplus      # 1.1.1.5
  - squashfs     # 1.1.1.6 - level 2
  - udf          # 1.1.1.7
  - usb-storage  # 1.1.24
  - dccp  # 3.4.1 - level 2
  - sctp  # 3.4.2 - level 2
  - rds   # 3.4.3 - level 2
  - tipc  # 3.4.4 - level 2
tmpMount:
  enabled: true # 1.1.2
  options:
    - nodev   # 1.1.3
    - nosuid  # 1.1.4
    - noexec  # 1.1.5
shmMount:
  enabled: true # 1.1.6
  options:
    - nosuid  # 1.1.8
    - nodev   # 1.1.7
    - noexec  # 1.1.9
kernelParams:
  kernel.randomize_va_space: 2  # 1.5.2
  fs.suid_dumpable: 2           # 1.5.4
  kernel.core_pattern: "|/usr/share/apport/apport %p %s %c %d %P %E"  # 1.5.4 - if fs.suid_dumpable == 2
  net.ipv6.conf.all.disable_ipv6: 1        # 3.1.1
  net.ipv6.conf.default.disable_ipv6: 1    # 3.1.1
  net.ipv4.conf.all.send_redirects: 0      # 3.2.1
  net.ipv4.conf.default.send_redirects: 0  # 3.2.1
  net.ipv4.ip_forward: 0           # 3.2.2 - this 100% breaks k8s/docker
  net.ipv6.conf.all.forwarding: 0  # 3.2.2
  net.ipv4.conf.all.accept_source_route: 0      # 3.3.1
  net.ipv4.conf.default.accept_source_route: 0  # 3.3.1
  net.ipv6.conf.all.accept_source_route: 0      # 3.3.1
  net.ipv6.conf.default.accept_source_route: 0  # 3.3.1
  net.ipv4.conf.all.accept_redirects: 0         # 3.3.2
  net.ipv4.conf.default.accept_redirects: 0     # 3.3.2
  net.ipv6.conf.all.accept_redirects: 0         # 3.3.2
  net.ipv6.conf.default.accept_redirects: 0     # 3.3.2
  net.ipv4.conf.all.secure_redirects: 0         # 3.3.3
  net.ipv4.conf.default.secure_redirects: 0     # 3.3.3
  net.ipv4.conf.all.log_martians: 1        # 3.3.4
  net.ipv4.conf.default.log_martians: 1    # 3.3.4
  net.ipv4.icmp_echo_ignore_broadcasts: 1  # 3.3.5
  net.ipv4.icmp_ignore_bogus_error_responses: 1  # 3.3.6
  net.ipv4.conf.all.rp_filter: 1      # 3.3.7
  net.ipv4.conf.default.rp_filter: 1  # 3.3.7
  net.ipv4.tcp_syncookies: 1          # 3.3.8
  net.ipv6.conf.all.accept_ra: 0      # 3.3.9
  net.ipv6.conf.default.accept_ra: 0  # 3.3.9
packages:
  installed:
    - apparmor # 1.6.1
    - osquery  # 1.3.1 - instead of AIDE or tripwire
    - systemd-timesyncd # 2.1.1.1
    - ufw  # 3.5.1.1
  uninstalled:
    - prelink  # 1.5.3
    - gdm3     # 1.8
    - xinetd
    - openbsd-inetd
    - ntp          # 2.1.1.1
    - chrony       # 2.1.1.1
    - avahi-daemon # 2.1.3
    - cups   # 2.1.4
    - isc-dhcp-server # 2.1.5
    - slapd  # 2.1.6
    - nfs-kernel-server # 2.1.7
    - bind9   # 2.1.8
    - vsftpd  # 2.1.9
    - apache2 # 2.1.10
    - dovecot-imapd  # 2.1.11
    - dovecot-pop3d  # 2.1.11
    - samba  # 2.1.12
    - squid  # 2.1.13
    - snmpd  # 2.1.14
    - rsync  # 2.1.16
    - nis    # 2.2.1
    - rsh-client  # 2.2.2
    - talk        # 2.2.3
    - telnet      # 2.2.4
    - ldap-utils  # 2.2.5
    - rpcbind     # 2.2.6
    - iptables-persistent # 3.5.1.2
    - nftables # 3.5.2.1 - not installed because ufw is installed
services:
  enabled:
    - osqueryd  # 1.3.2 - instead of AIDE or tripwire
    - systemd-timesyncd  # 2.1.1.2
    - ufw  # 3.5.1.3
  disabled:
    - autofs    # 1.1.23
    - nftables  # 3.5.2.9 - disabled because ufw is enabled
checkMotd: false  # /etc/motd does not exist on Zendesk image